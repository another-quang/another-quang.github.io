{"version":3,"sources":["components/Globe/CustomRingBufferGeometry.js","components/Globe/MyGlobe.js","components/Globe/Globe.js","components/AthleteList/AthleteFilters.js","components/AthleteList/AthleteCard.js","components/AthleteList/AthleteDetailCard.js","components/AthleteList/AthleteList.js","components/App.js","containers/AppContainer.js","actions/index.js","constants/ActionTypes.js","serviceWorker.js","reducers/phaseResults.js","reducers/selectedResult.js","reducers/globeStatus.js","reducers/filterOptions.js","reducers/index.js","store/configureStore.js","index.js"],"names":["CustomRingBufferGeometry","innerRadius","arguments","length","undefined","outerRadius","thetaSegments","phiSegments","thetaStart","thetaLength","Math","PI","color","geometry","THREE","type","segment","j","i","indices","vertices","normals","uvs","colors","attrStarted","radius","radiusStep","vertex","uv","threeColor","now","performance","randFloat","x","cos","y","sin","push","z","r","g","b","thetaSegmentLevel","a","c","d","setIndex","addAttribute","MyGlobe","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","renderer","scene","container","camera","object","controls","fov","altitude","initialDistance","globeProps","globeRadius","widthSegments","heightSegments","globeGroup","circleGroup","markerObject","raycaster","mouse","uniforms","color1","value","color2","started","animationDuration","rotationZ","prevProps","_this$props","phaseResults","selectedResult","globeStatus","redraw","firstItemOld","all","firstItemNew","n_PhaseResultID","updatePhaseResults","rotateCamera","geojson","lat","lng","highlightCircle","unHighlightCircle","viewDetails","zoomOut","_this2","_this$props2","setPOI","unsetPOI","document","getElementById","WIDTH","clientWidth","HEIGHT","clientHeight","setSize","position","set","lookAt","distanceTo","OrbitControls","domElement","autoRotate","autoRotateSpeed","background","add","appendChild","ambientLight","spotLight","load","texture","sphere","material","map","mesh","name","drag","canvas","addEventListener","event","globeObject","getObjectByName","canvasBounds","context","getBoundingClientRect","clientX","left","right","clientY","top","bottom","setFromCamera","children","remove","intersects","intersectObject","pointOfIntersection","point","addMarkerPOI2","_this$calculateLatLng","calculateLatLngCoordinates","render","requestAnimationFrame","TWEEN","update","state","spinning","circle","forEach","visible","poi","filtered","zoomFactor","target","calculate3dCoordinates","coeff","from","to","easing","Quartic","Out","onUpdate","copy","start","distanceToCenter","element","addCircle","spherical","setFromVector3","newPosition","setFromSpherical","circleMaterial","side","opacity","transparent","pie","shaderMaterial","vertexShader","textContent","fragmentShader","vertexColors","center","newCenter","medalColor","n_RankMedal","pulseGeometry","pulse","threeVector","radToDeg","phi","theta","parseInt","react_default","createElement","id","Component","Globe","setVisibleResults","onUnselectResult","Globe_MyGlobe","AthleteFilters","resetValues","sport","gender","medal","sortby","objectSpread","onChange","bind","assertThisInitialized","onReset","setFilters","newFilterValues","setState","filterOptions","showFilters","sportNames","key","concat","genderNames","medalNames","cssClass","className","htmlFor","onClick","AthleteCard","result","isActive","formattedDate","format","parse","d_PhaseDate","c_Person","c_Team","medalCssClass","e","preventDefault","c_EventGender","c_Sportname","c_CompetitionName","c_PhaseCity","c_PhaseCountry","AthleteDetailCard","c_Result","c_ResultType","n_PersonAgeYears","AthleteList","cardRef","React","createRef","autoPlay","autoPlayId","autoPlayInterval","autoRefresh","daysAgo","refreshInterval","refreshTimer","autoPlayTimer","onClickToggleFilters","onClickRefresh","onClickAutoPlay","triggerAutoScripts","onSelectResult","window","clearInterval","fetchGraceNoteData","newDaysAgo","currentId","currentIndex","nextIndex","findIndex","nextResult","current","childNodes","scrollIntoView","block","behavior","setInterval","focusNextResult","filteredResults","poiResults","cardSource","athleteCards","components_AthleteList_AthleteCard","onClickAthleteCard","filterCssClass","refreshCssClass","loading","autoPlayCssClass","heading","title","AthleteList_AthleteFilters","ref","components_AthleteList_AthleteDetailCard","onCloseDetail","App","components_Globe_Globe","components_AthleteList_AthleteList","AppContainer","connect","dispatch","options","nationality","hasMedal","_options$limit","limit","fetch","then","response","json","results","slice","countryGeo","countries","find","Country","countryCode","cityGeo","countryCity","countryCities","country","cities","receiveGraceNoteData","isAutoPlay","selectResult","Boolean","location","hostname","match","initialState","error","currentAutoPlayId","sortBy","order","sortOrder","action","copyState","distance","sqrt","filter","sort","ignoreSportName","ignoreGender","ignoreMedal","ignoreName","sortKey","toUpperCase","includes","assign","getAvailableFields","fieldName","temp","array","toConsumableArray","Set","unshift","rootReducer","combineReducers","middlewares","thunk","promise","store","createStore","applyMiddleware","apply","es","containers_AppContainer","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.35edb074.chunk.js","sourcesContent":["import * as THREE from 'three'\n\nexport default function CustomRingBufferGeometry(innerRadius = 0.5, outerRadius = 1, thetaSegments = 8, phiSegments = 1, thetaStart = 0, thetaLength = Math.PI * 2, color = 0xff0000) {\n\t// buffers\n\n  const geometry = new THREE.BufferGeometry();\n  geometry.type = 'RingBufferGeometry';\n\n\tconst indices = [];\n\tconst vertices = [];\n\tconst normals = [];\n  const uvs = [];\n  const colors = [];\n  const attrStarted = [];\n\n\t// helper variables\n\tvar segment;\n\tvar radius = innerRadius;\n\tvar radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\n\tvar vertex = new THREE.Vector3();\n\tvar uv = new THREE.Vector2();\n\tvar j, i;\n\n  // Adding random starting time\n  const threeColor = new THREE.Color(color)\n  const now = performance.now() + THREE.Math.randFloat(-4000,0)\n\n\t// generate vertices, normals and uvs\n\n\tfor ( j = 0; j <= phiSegments; j ++ ) {\n\n\t\tfor ( i = 0; i <= thetaSegments; i ++ ) {\n\n\t\t\t// values are generate from the inside of the ring to the outside\n\n\t\t\tsegment = thetaStart + i / thetaSegments * thetaLength;\n\n\t\t\t// vertex\n\n\t\t\tvertex.x = radius * Math.cos( segment );\n\t\t\tvertex.y = radius * Math.sin( segment );\n\n\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t// normal\n\n\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t// uv\n\n\t\t\tuv.x = ( vertex.x / outerRadius + 1 ) / 2;\n\t\t\tuv.y = ( vertex.y / outerRadius + 1 ) / 2;\n\n\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t// center point\n  \t\tcolors.push(threeColor.r, threeColor.g, threeColor.b);\n  \t\tattrStarted.push(now);\n\t\t}\n\n\t\t// increase the radius for next row of vertices\n\n\t\tradius += radiusStep;\n\n\t}\n\n\t// indices\n\n\tfor ( j = 0; j < phiSegments; j ++ ) {\n\n\t\tvar thetaSegmentLevel = j * ( thetaSegments + 1 );\n\n\t\tfor ( i = 0; i < thetaSegments; i ++ ) {\n\n\t\t\tsegment = i + thetaSegmentLevel;\n\n\t\t\tvar a = segment;\n\t\t\tvar b = segment + thetaSegments + 1;\n\t\t\tvar c = segment + thetaSegments + 2;\n\t\t\tvar d = segment + 1;\n\n\t\t\t// faces\n\n\t\t\tindices.push( a, b, d );\n\t\t\tindices.push( b, c, d );\n\n\t\t}\n\n\t}\n\n\t// build geometry\n\n\tgeometry.setIndex( indices );\n\tgeometry.addAttribute( 'position', new THREE.Float32BufferAttribute( vertices, 3 ) );\n\tgeometry.addAttribute( 'normal', new THREE.Float32BufferAttribute( normals, 3 ) );\n  geometry.addAttribute( 'uv', new THREE.Float32BufferAttribute( uvs, 2 ) );\n  geometry.addAttribute( 'color', new THREE.Float32BufferAttribute( colors, 3 ) );\n  geometry.addAttribute( 'attrStarted', new THREE.Float32BufferAttribute( attrStarted, 1 ));\n\n  return geometry;\n}\n","import React, { Component } from 'react';\nimport * as THREE from 'three'\nimport * as TWEEN from '@tweenjs/tween.js'\nimport OrbitControls from 'threejs-orbit-controls'\nimport CustomRingBufferGeometry from './CustomRingBufferGeometry'\n\n// TODO:\n// https://threejs.org/examples/?q=attr#webgl_custom_attributes\n// https://github.com/mrdoob/three.js/blob/master/examples/webgl_buffergeometry_custom_attributes_particles.html\n// https://gist.github.com/jeanlescure/e27c93b73a10b64e85e4\n// http://learnwebgl.brown37.net/12_shader_language/glsl_introduction.html\n\nclass MyGlobe extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderer = new THREE.WebGLRenderer()\n\t\tthis.scene = new THREE.Scene()\n\t\tthis.container = null\n\t\tthis.camera = {\n\t\t\tobject: null, // camera object\n\t\t\tcontrols: null, // orbitControls object\n\t\t\tfov: 60,\n\t\t\taltitude: 400,\n\t\t\tinitialDistance: 0\n\t\t}\n\n\t\tthis.globeProps = {\n\t\t\tglobeRadius: 200,\n\t\t\twidthSegments: 100,\n\t\t\theightSegments: 100\n\t\t}\n\n\t\tthis.globeGroup = new THREE.Group()\n\t\tthis.circleGroup = new THREE.Group()\n\t\tthis.markerObject = new THREE.Object3D()\n\n\t\tthis.raycaster = new THREE.Raycaster()\n\t\tthis.mouse = new THREE.Vector2()\n\n\t\tthis.uniforms = {\n\t\t\t'color1': { type : 'c', value : new THREE.Color(0x00ff00) },\n\t\t\t'color2': { type : 'c', value : new THREE.Color(0xffffff) },\n\t\t\t'now': { type: 'f', value: 1.0 },\n\t\t\t'started': { type: 'f', value: 1.0},\n\t\t\t'animationDuration': { type: 'f', value: 5000.0},\n\t\t\t'rotationZ':  { type: \"f\", value: - Math.PI / 2 + Math.PI / 10 },\n\t\t}\n\t}\n\n\tcomponentDidUpdate(prevProps) {\n\t\tconst { phaseResults, selectedResult, globeStatus } = this.props\n\n\t\t// Check to see if we need to redraw all the circles as the data is reloaded\n\t\tlet redraw = false\n\t\tif (prevProps.phaseResults !== undefined) {\n\t\t\tconst firstItemOld = prevProps.phaseResults.all[0] !== undefined ? prevProps.phaseResults.all[0] : false\n\t\t\tconst firstItemNew = phaseResults.all[0] !== undefined ? phaseResults.all[0] : false\n\t\t\tif (prevProps.phaseResults.all.length !== phaseResults.all.length || firstItemOld.n_PhaseResultID !== firstItemNew.n_PhaseResultID) {\n\t\t\t\tredraw = true\n\t\t\t}\n\t\t}\n\t\tthis.updatePhaseResults(phaseResults, redraw)\n\n\t\t// Check to see if a phase result is selected manually or via autoPlay\n\t\tif (selectedResult !== null && selectedResult.n_PhaseResultID !== undefined) {\n\t\t\tthis.rotateCamera(selectedResult.geojson.lat, selectedResult.geojson.lng, 1.2)\n\t\t\tthis.highlightCircle(selectedResult)\n\t\t} else {\n\t\t\tthis.unHighlightCircle(phaseResults)\n\t\t}\n\n\t\tif (prevProps.globeStatus.viewDetails === true && globeStatus.viewDetails === false) {\n\t\t\tthis.zoomOut()\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { setPOI, unsetPOI } = this.props\n\t\tconst _this = this\n\t\tthis.container = document.getElementById('my-globe')\n\n\t\tconst WIDTH = this.container.clientWidth\n\t\tconst HEIGHT = this.container.clientHeight\n\n\t\t/** Renderer */\n\t\tthis.renderer.setSize(WIDTH, HEIGHT)\n\n\t\t/** Camera */\n\t\tthis.camera.object = new THREE.PerspectiveCamera(this.camera.fov, WIDTH / HEIGHT, 1, 10000)\n\t\tthis.camera.object.position.set(0, 200, this.camera.altitude)\n\t\tthis.camera.object.lookAt(new THREE.Vector3(0, 0, 0))\n\t\tthis.camera.initialDistance = this.camera.object.position.distanceTo(new THREE.Vector3(0,0,0))\n\t\tthis.camera.controls = new OrbitControls(this.camera.object, this.renderer.domElement)\n\t\tthis.camera.controls.autoRotate = true\n\t\tthis.camera.controls.autoRotateSpeed = .5\n\n\t\t/** Scene */\n\t\tthis.scene.background = new THREE.Color( 0x000 )\n\t\tthis.scene.add(this.camera.object)\n\t\tthis.container.appendChild(this.renderer.domElement)\n\n\t\t/** Lighting */\n\t\tconst ambientLight = new THREE.AmbientLight(0x404040)\n\t\tthis.scene.add(ambientLight)\n\t\tconst spotLight = new THREE.PointLight(0xffffff);\n\t\tspotLight.position.set(500, 500, 500);\n\t\tthis.camera.object.add(spotLight);\n\n\t\t/** Objects in scene */\n\t\tconst loader = new THREE.TextureLoader()\n\t\tloader.load( 'https://another-quang.github.io/build/assets/day_2048.jpg', texture => {\n\t\t\tconst sphere = new THREE.SphereGeometry(this.globeProps.globeRadius, this.globeProps.widthSegments, this.globeProps.heightSegments)\n\t\t\tconst material = new THREE.MeshLambertMaterial({\n\t\t\t\tmap: texture,\n\t\t\t\t// color: 0xffffff,\n\t\t\t\t// wireframe: true\n\t\t\t})\n\t\t\tconst mesh = new THREE.Mesh(sphere, material)\n\t\t\tmesh.name = 'globe'\n\t\t\tthis.globeGroup.add(mesh)\n\t\t})\n\n\t\tthis.scene.add(this.globeGroup)\n\t\tthis.scene.add(this.circleGroup)\n\t\tthis.scene.add(this.markerObject)\n\t\t// this.globeGroup.add(new THREE.AxesHelper(1000))\n\t\t// this.globeGroup.add(new THREE.GridHelper(1000, 10, 0x0000ff, 0x808080))\n\n\t\t/** Mouse interaction */\n\n\t\tlet drag = false\n\t\tconst canvas = this.renderer.domElement\n\t\tcanvas.addEventListener('mousedown', () => drag = false)\n\t\tcanvas.addEventListener('mousemove', () => drag = true)\n\t\tcanvas.addEventListener('mouseup', (event) => {\n\t\t\tif (drag === false) {\n\t\t\t\tconst globeObject = _this.globeGroup.getObjectByName('globe')\n\t\t\t\tconst canvasBounds = this.renderer.context.canvas.getBoundingClientRect()\n\t\t\t\t_this.mouse.x = ((event.clientX - canvasBounds.left) / (canvasBounds.right - canvasBounds.left)) * 2 - 1\n\t\t\t\t_this.mouse.y = -((event.clientY - canvasBounds.top) / (canvasBounds.bottom - canvasBounds.top)) * 2 + 1\n\t\t\t\t_this.raycaster.setFromCamera(_this.mouse, _this.camera.object)\n\n\t\t\t\twhile(_this.markerObject.children.length > 0) {\n\t\t\t\t\t_this.markerObject.remove(_this.markerObject.children[0])\n\t\t\t\t}\n\t\t\t\t// Intersection point\n\t\t\t\tconst intersects = _this.raycaster.intersectObject(globeObject)\n\t\t\t\tif (intersects.length === 0) {\n\t\t\t\t\t_this.zoomOut()\n\t\t\t\t\tunsetPOI()\n\t\t\t\t\treturn this.camera.controls.autoRotate = true\n\t\t\t\t}\n\t\t\t\tconst pointOfIntersection = intersects[0].point\n\t\t\t\t_this.addMarkerPOI2(pointOfIntersection)\n\t\t\t\tconst { lat, lng } = _this.calculateLatLngCoordinates(pointOfIntersection)\n\t\t\t\t_this.rotateCamera(lat, lng, 1.2)\n\t\t\t\tsetPOI(lat, lng)\n\t\t\t}\n\t\t})\n\n\t\t// const centerDistance = this.camera.object.position.distanceTo(new THREE.Vector3(0, 0, 0))\n\t\t// const tangentDistance = Math.cos(Math.PI / 180 * this.camera.fov / 2) * centerDistance\n\n\t\tconst started = performance.now()\n\t\t_this.uniforms.started.value = started\n\t\tlet now = started\n\t\t/** Animation */\n\t\tfunction render () {\n\t\t\trequestAnimationFrame(render)\n\n\t\t\t// Update radar marker and circles\n\t\t\tnow = performance.now()\n\t\t\t_this.uniforms.now.value = now\n\t\t\t_this.uniforms.rotationZ.value -= 0.03\n\t\t\t// _this.markerObject.rotateZ(Math.PI / 100)\n\n\t\t\t// Update camera movement\n\t\t\tTWEEN.update()\n\t\t\t_this.camera.controls.update()\n\n\t\t\t// Render scene\n\t\t\t_this.renderer.render(_this.scene, _this.camera.object)\n\t\t}\n\n\t\trender()\n\t}\n\n\tapplyStatus() {\n\t\tthis.camera.controls.autoRotate = this.state.spinning\n\t}\n\n\thighlightCircle(selectedResult) {\n\t\tconst circle = this.circleGroup.getObjectByName(selectedResult.n_PhaseResultID)\n\t\tif (typeof(circle) !== 'undefined') {\n\t\t\tthis.circleGroup.children.forEach(c => c.visible = false)\n\t\t\tcircle.visible = true\n\t\t}\n\t}\n\n\tunHighlightCircle(phaseResults) {\n\t\tconst _this = this\n\t\tconst visibleResults = phaseResults.poi.length > 0 ? phaseResults.poi : phaseResults.filtered\n\t\tvisibleResults.forEach(x => {\n\t\t\tconst circle = _this.circleGroup.getObjectByName(x.n_PhaseResultID)\n\t\t\treturn circle !== undefined ? circle.visible = true : null\n\t\t})\n\t}\n\n\trotateCamera(lat, lng, zoomFactor = 1) {\n\t\tconst _this = this\n\t\tthis.camera.controls.autoRotate = false\n\n\t\tconst target = this.calculate3dCoordinates(lat, lng, this.globeProps.globeRadius)\n\n\t\tconst coeff = this.camera.altitude / this.globeProps.globeRadius / zoomFactor\n\t\tlet from = {\n\t\t\tx: this.camera.object.position.x,\n\t\t\ty: this.camera.object.position.y,\n\t\t\tz: this.camera.object.position.z\n\t\t}\n\n\t\tconst to = {\n\t\t\tx: target.x * coeff,\n\t\t\ty: target.y * coeff,\n\t\t\tz: target.z * coeff\n\t\t}\n\n\t\treturn new TWEEN.Tween(from)\n\t\t\t.to(to, 2000)\n\t\t\t.easing(TWEEN.Easing.Quartic.Out)\n\t\t\t.onUpdate(() => {\n\t\t\t\t_this.camera.object.position.copy(from);\n\t\t\t\t_this.camera.object.lookAt(new THREE.Vector3(0, 0, 0));\n\t\t\t})\n\t\t\t.start()\n\t}\n\n\tzoomOut() {\n\t\tconst _this = this\n\t\tconst distanceToCenter = this.camera.object.position.distanceTo(new THREE.Vector3(0, 0, 0))\n\t\tconst coeff = this.camera.initialDistance / distanceToCenter\n\n\t\tlet from = {\n\t\t\tx: this.camera.object.position.x,\n\t\t\ty: this.camera.object.position.y,\n\t\t\tz: this.camera.object.position.z\n\t\t}\n\n\t\tconst to = {\n\t\t\tx: this.camera.object.position.x * coeff,\n\t\t\ty: this.camera.object.position.y * coeff,\n\t\t\tz: this.camera.object.position.z * coeff\n\t\t}\n\n\t\treturn new TWEEN.Tween(from)\n\t\t\t.to(to, 2000)\n\t\t\t.easing(TWEEN.Easing.Quartic.Out)\n\t\t\t.onUpdate(() => {\n\t\t\t\t_this.camera.object.position.copy(from);\n\t\t\t\t_this.camera.object.lookAt(new THREE.Vector3(0, 0, 0));\n\t\t\t})\n\t\t\t.start()\n\t}\n\n\tupdatePhaseResults(phaseResults, redraw = false) {\n\t\tvar _this = this\n\t\tif (redraw === true) {\n\t\t\t// Remove all existing circles\n\t\t\twhile (this.circleGroup.children.length > 0) {\n\t\t\t\tthis.circleGroup.remove(this.circleGroup.children[0])\n\t\t\t}\n\t\t\t// Redraw all the new circles\n\t\t\treturn phaseResults.all.forEach(element => {\n\t\t\t\tif (element.geojson !== undefined) {\n\t\t\t\t\t_this.addCircle(element)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tif (this.circleGroup.children.length === 0) {\n\t\t\t// Draw all circles in first load\n\t\t\tphaseResults.all.forEach(element => {\n\t\t\t\tif (element.geojson !== undefined) {\n\t\t\t\t\t_this.addCircle(element)\n\t\t\t\t}\n\t\t\t})\n\t\t} else {\n\t\t\t// Hide all circles and show only what's filtered or poi'ed\n\t\t\tthis.circleGroup.children.forEach(x => x.visible = false)\n\t\t\tconst visibleResults = phaseResults.poi.length > 0 ? phaseResults.poi : phaseResults.filtered\n\t\t\tvisibleResults.forEach(x => {\n\t\t\t\tconst circle = _this.circleGroup.getObjectByName(x.n_PhaseResultID)\n\t\t\t\treturn circle !== undefined ? circle.visible = true : null\n\t\t\t})\n\t\t}\n\t}\n\n\taddMarkerPOI(position) {\n\t\tconst spherical = new THREE.Spherical()\n\t\tspherical.setFromVector3(position)\n\t\tspherical.radius += .2\n\n\t\tconst newPosition = new THREE.Vector3()\n\t\tnewPosition.setFromSpherical(spherical)\n\n\t\tconst distanceThreshold = 20\n\t\tconst circleMaterial = new THREE.MeshBasicMaterial({\n\t\t\tside: THREE.DoubleSide,\n\t\t\tcolor: 0x9cff57,\n\t\t\topacity: 0.5,\n\t\t\ttransparent: true\n\t\t})\n\t\tconst point = new THREE.Mesh(new THREE.CircleGeometry(0.5, 32), circleMaterial)\n\t\tthis.markerObject.add(point)\n\n\t\tconst pie = new THREE.Mesh(new THREE.CircleGeometry(distanceThreshold, 32, 0, Math.PI / 10), circleMaterial)\n\t\tthis.markerObject.add(pie)\n\n\t\t// Set poistion and face for marker\n\t\tthis.markerObject.position.copy(newPosition)\n\t\tthis.markerObject.lookAt(new THREE.Vector3(0 ,0, 0))\n\t}\n\n\taddMarkerPOI2(position) {\n\t\t// Lift the radar off the surface a little bit\n\t\tconst spherical = new THREE.Spherical()\n\t\tspherical.setFromVector3(position)\n\t\tspherical.radius += .5\n\n\t\tconst newPosition = new THREE.Vector3()\n\t\tnewPosition.setFromSpherical(spherical)\n\n\t\tconst distanceThreshold = 30\n\n\t\tconst geometry = new THREE.CircleBufferGeometry(distanceThreshold, 32, 0, Math.PI / 6)\n\t\tconst shaderMaterial = new THREE.ShaderMaterial({\n\t\t\tside: THREE.DoubleSide,\n\t\t\tuniforms: this.uniforms,\n\t\t\tvertexShader: document.getElementById('vertexShaderRadar').textContent,\n\t\t\tfragmentShader: document.getElementById('fragmentShaderRadar').textContent,\n\t\t\ttransparent: true,\n\t\t\tvertexColors: true,\n\t\t})\n\t\tconst pie = new THREE.Mesh(geometry, shaderMaterial)\n\t\tthis.markerObject.add(pie)\n\n\t\t// Set poistion and face for marker\n\t\tthis.markerObject.position.copy(newPosition)\n\t\tthis.markerObject.lookAt(new THREE.Vector3(0 ,0, 0))\n\t}\n\n\taddCircle(element) {\n\t\tconst center = this.calculate3dCoordinates(element.geojson.lat + THREE.Math.randFloat(-2, 2), element.geojson.lng + THREE.Math.randFloat(-2, 2), this.globeProps.globeRadius)\n\t\t// Lift the circle off the surface a little bit\n\t\tconst spherical = new THREE.Spherical()\n\t\tspherical.setFromVector3(center)\n\t\tspherical.radius += THREE.Math.randFloat(.05, .25)\n\n\t\tconst newCenter = new THREE.Vector3()\n\t\tnewCenter.setFromSpherical(spherical)\n\n\n\t\tconst medalColor = element.n_RankMedal === 1 ? 0xffff00 : (element.n_RankMedal === 2 ? 0xefefef : 0xfe8e09)\n\t\tconst radius = THREE.Math.randFloat(5, 10)\n\t\tconst innerRadius = radius - THREE.Math.randFloat(0.5, 1.5)\n\t\tlet pulseGeometry = new CustomRingBufferGeometry(innerRadius, radius, 32, 1, 0, Math.PI * 2, medalColor)\n\n\t\tconst shaderMaterial = new THREE.ShaderMaterial({\n\t\t\tuniforms:  this.uniforms,\n\t\t\tvertexShader: document.getElementById('vertexShader').textContent,\n\t\t\tfragmentShader: document.getElementById('fragmentShader').textContent,\n\t\t\tvertexColors: true,\n\t\t\ttransparent: true,\n\t\t\topacity: 1.0,\n\t\t\tside: THREE.DoubleSide,\n\t\t})\n\n\t\tconst pulse = new THREE.Mesh(pulseGeometry, shaderMaterial)\n\n\t\tpulse.name = element.n_PhaseResultID\n\t\tpulse.position.copy(newCenter)\n\t\tpulse.lookAt(new THREE.Vector3(0, 0, 0))\n\t\tthis.circleGroup.add(pulse)\n\t}\n\n\tcalculateLatLngCoordinates(threeVector) {\n\t\tconst spherical = new THREE.Spherical()\n\t\tspherical.setFromVector3(threeVector)\n\t\tconst lat = THREE.Math.radToDeg(Math.PI / 2 - spherical.phi)\n\t\tlet lng = THREE.Math.radToDeg(spherical.theta - Math.PI / 2)\n\t\tlng = lng < -180 ? lng + 360 : lng\n\t\treturn {lat, lng}\n\t}\n\n\tcalculate3dCoordinates(lat, lng, radius) {\n\t\tconst phi   = (90 - parseInt(lat, 10)) * (Math.PI / 180)\n\t\tconst theta = (parseInt(lng, 10) + 180) * (Math.PI / 180)\n\t\tconst x = -((radius) * Math.sin(phi) * Math.cos(theta))\n\t\tconst z = ((radius) * Math.sin(phi) * Math.sin(theta))\n\t\tconst y = ((radius) * Math.cos(phi))\n\n\t\treturn new THREE.Vector3(x, y, z)\n\t}\n\n\trender() {\n\t\treturn ( <div id=\"my-globe\"></div> );\n\t}\n}\n\nexport default MyGlobe;\n","import React, { Component } from 'react'\nimport MyGlobe from './MyGlobe'\nimport './Globe.scss'\n\nclass Globe extends Component {\n  render() {\n    const {phaseResults, selectedResult, globeStatus, setVisibleResults, setPOI, unsetPOI,onUnselectResult} = this.props\n    return (\n      <MyGlobe\n        phaseResults={phaseResults}\n        selectedResult={selectedResult}\n        globeStatus={globeStatus}\n        setVisibleResults={setVisibleResults}\n        setPOI={setPOI}\n        unsetPOI={unsetPOI}\n        onUnselectResult={onUnselectResult}\n        />\n    );\n  }\n}\n\nexport default Globe;","import React, { Component } from 'react'\n\nclass AthleteFilters extends Component {\n  constructor(props) {\n    super(props)\n\n    this.resetValues = {\n      sport: 'All',\n      gender: 'All',\n      medal: 'All',\n      name: '',\n      sortby: 'time-desc'\n    }\n\n    this.state = { ...this.resetValues }\n\n    this.onChange = this.onChange.bind(this)\n    this.onReset = this.onReset.bind(this)\n  }\n\n  onChange() {\n    const { setFilters } = this.props\n    const newFilterValues = {\n      sport: document.getElementById('sport-name').value,\n      gender: document.getElementById('sport-gender').value,\n      medal: document.getElementById('sport-medal').value,\n      name: document.getElementById('athlete-name').value,\n      sortby: document.getElementById('sort-by').value,\n    }\n    return this.setState(newFilterValues, setFilters(newFilterValues))\n  }\n\n  onReset() {\n    const { setFilters } = this.props\n    return this.setState({ ...this.resetValues }, setFilters(this.resetValues))\n  }\n\n  render() {\n    const { filterOptions, showFilters } = this.props\n    const sportNames = filterOptions.sport.map(x => (<option key={`sport-${x}`} value={x}>{x}</option>))\n    const genderNames = filterOptions.gender.map(x => (<option key={`gender-${x}`} value={x}>{x}</option>))\n    const medalNames = filterOptions.medal.map(x => (<option key={`medal-${x}`} value={x}>{x}</option>))\n    const cssClass = showFilters === true ? '' : 'd-none'\n    return (\n      <div className={cssClass}>\n        <div className=\"form-row\">\n          <div className=\"col-6\">\n            <div className=\"form-group\">\n              <label htmlFor=\"sport-name\">Sport</label>\n              <select id=\"sport-name\" name=\"sport\" value={this.state.sport} className=\"form-control\" onChange={this.onChange}>\n                {sportNames}\n              </select>\n            </div>\n          </div>\n          <div className=\"col-3\">\n            <div className=\"form-group\">\n              <label htmlFor=\"sport-gender\">Gender</label>\n              <select id=\"sport-gender\" name=\"gender\" value={this.state.gender} className=\"form-control\" onChange={this.onChange}>\n                {genderNames}\n              </select>\n            </div>\n          </div>\n          <div className=\"col-3\">\n            <div className=\"form-group\">\n              <label htmlFor=\"sport-medal\">Medal</label>\n              <select id=\"sport-medal\" name=\"medal\" value={this.state.medal} className=\"form-control\" onChange={this.onChange}>\n                {medalNames}\n              </select>\n            </div>\n          </div>\n        </div>\n        <div className=\"form-row\">\n          <div className=\"col-9\">\n            <div className=\"form-group\">\n              <label htmlFor=\"athlete-name\">Athelete name</label>\n              <input id=\"athlete-name\" name=\"name\" value={this.state.name} type=\"text\" className=\"form-control\" onChange={this.onChange} />\n            </div>\n          </div>\n          <div className=\"col-3\">\n            <div className=\"form-group\">\n              <label htmlFor=\"sort-by\">Sort by</label>\n              <select id=\"sort-by\" name=\"sortby\" value={this.state.sortby} className=\"form-control\" onChange={this.onChange}>\n                <option value=\"time-desc\">Newest first</option>\n                <option value=\"time-asc\">Oldest first</option>\n              </select>\n            </div>\n          </div>\n        </div>\n\n        <button className=\"btn btn-link p-0\" onClick={this.onReset}>Reset filters</button>\n      </div>\n     )\n  }\n}\n\nexport default AthleteFilters","import React, { Component } from 'react'\nimport {format, parse} from 'date-fns'\nimport './AthleteCard.scss'\n\nclass AthleteCard extends Component {\n  render() {\n    const { result, onClick, isActive } = this.props\n    const formattedDate = format(parse(result.d_PhaseDate), 'D MMMM YYYY')\n    const name = result.c_Person === null ? `Team ${result.c_Team}` : result.c_Person\n    let medalCssClass = ''\n    let medal = ''\n    switch (result.n_RankMedal) {\n      case 1:\n        medalCssClass = 'medal--gold'\n        medal = '🥇'\n        break\n      case 2:\n        medalCssClass = 'medal--silver'\n        medal = '🥈'\n        break\n      case 3:\n        medalCssClass = 'medal--bronze'\n        medal = '🥉'\n        break\n      default:\n        break\n    }\n    // const medal = result.n_RankMedal === 1 ? \"🥇\" : (result.n_RankMedal === 2 ? \"🥈\" : (result.n_RankMedal === 3 ? \"🥉\" : result.n_RankMedal))\n    const cssClass = `athlete-card media border border-dark rounded mb-3 p-3 pb-0 ${medalCssClass} ${isActive ? 'athlete-card--active' : ''}`\n    return (\n      <div className={cssClass} onClick={e => {e.preventDefault();onClick();}}>\n        <div className=\"media-body\">\n          <h5 className=\"mt-0\">{medal} {name}</h5>\n          <p className=\"mb-0 text-muted\">\n            {result.c_EventGender} { result.c_Sportname}, {result.c_CompetitionName}<br/>\n            <small className=\"text-muted\">\n              {result.c_PhaseCity} {result.c_PhaseCountry}<br/>\n              {formattedDate}\n            </small>\n          </p>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default AthleteCard;","import React, { Component } from 'react'\nimport {format, parse} from 'date-fns'\nimport './AthleteDetailCard.scss'\n\nclass AthleteDetailCard extends Component {\n  render() {\n    const { selectedResult, onClick } = this.props\n    if (selectedResult === null) {\n      return <div className=\"athlete-detail__card media rounded mb-3 p-3 pb-0\"></div>\n    }\n    const formattedDate = format(parse(selectedResult.d_PhaseDate), 'D MMMM YYYY')\n    const name = selectedResult.c_Person === null ? `Team ${selectedResult.c_Team}` : selectedResult.c_Person\n    let medal, medalCssClass\n    const result = selectedResult.c_Result !== null ? (<span>Result ({selectedResult.c_ResultType}): {selectedResult.c_Result}</span>) : null\n    switch (selectedResult.n_RankMedal) {\n      case 1:\n        medalCssClass = 'medal--gold'\n        medal = '🥇'\n        break\n      case 2:\n        medalCssClass = 'medal--silver'\n        medal = '🥈'\n        break\n      case 3:\n        medalCssClass = 'medal--bronze'\n        medal = '🥉'\n        break\n      default:\n        break\n    }\n\n    const cssClass = `athlete-detail__card media rounded mb-3 p-3 pb-0 ${medalCssClass}`\n    return (\n      <div className={cssClass} onClick={e => {e.preventDefault();onClick();}}>\n        <div className=\"media-body text-center\">\n          <h1 className=\"my-3 d-flex align-items-center\"><i className=\"material-icons material-icons--large\">navigate_before</i> {name}</h1>\n          <p className=\"display-2\">{medal}</p>\n          <h3>{selectedResult.c_EventGender} { selectedResult.c_Sportname}</h3>\n          <h4 className=\"text-secondary\">{selectedResult.c_CompetitionName}</h4>\n          <hr/>\n          <p className=\"text-muted\">\n            {formattedDate} {selectedResult.n_PersonAgeYears ? `(${selectedResult.n_PersonAgeYears} years old)` : ''} <br/>\n            {selectedResult.c_PhaseCity}, {selectedResult.c_PhaseCountry} <br/>\n            {result}\n          </p>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default AthleteDetailCard","import React, { Component } from 'react'\nimport Spinner from 'react-spinkit'\nimport AthleteFilters from './AthleteFilters'\nimport AthleteCard from './AthleteCard'\nimport AthleteDetailCard from './AthleteDetailCard'\nimport './AthleteList.scss'\n\nclass AthleteList extends Component {\n  constructor(props) {\n    super(props)\n\n    this.cardRef = React.createRef()\n\n    this.state = {\n      showFilters: false,\n      autoPlay: false,\n      autoPlayId: null,\n      autoPlayInterval: 10000,\n      autoRefresh: false,\n      daysAgo: 60,\n      refreshInterval: 3600000, // one every hour\n    }\n\n    this.refreshTimer = null\n    this.autoPlayTimer = null\n\n    this.onClickToggleFilters = this.onClickToggleFilters.bind(this)\n    this.onClickRefresh = this.onClickRefresh.bind(this)\n    this.onClickAutoPlay = this.onClickAutoPlay.bind(this)\n    this.triggerAutoScripts = this.triggerAutoScripts.bind(this)\n  }\n\n  onClickToggleFilters() {\n    return this.setState({ showFilters: !this.state.showFilters })\n  }\n\n  onClickAthleteCard(result) {\n    const { onSelectResult } = this.props\n    const autoPlay = false\n    window.clearInterval(this.autoPlayTimer)\n    return this.setState({ autoPlay: autoPlay }, onSelectResult(result, autoPlay))\n  }\n\n  onCloseDetail() {\n    const { onUnselectResult } = this.props\n    return onUnselectResult()\n  }\n\n  onClickRefresh() {\n    const { fetchGraceNoteData } = this.props\n    const newDaysAgo = this.state.daysAgo\n    this.setState({ daysAgo: newDaysAgo }, () => fetchGraceNoteData({ daysAgo: newDaysAgo }))\n  }\n\n  onClickAutoPlay() {\n    const _this = this\n    this.setState({ autoPlay: !this.state.autoPlay, autoRefresh: !this.state.autoRefresh }, () => _this.triggerAutoScripts())\n  }\n\n  focusNextResult() {\n    const { phaseResults, onSelectResult } = this.props\n    let currentId, currentIndex, nextIndex\n    if (this.state.autoPlayId === null) {\n      nextIndex = 0\n    } else {\n      currentId = this.state.autoPlayId\n      currentIndex = phaseResults.filtered.findIndex(x => x.n_PhaseResultID === currentId)\n      nextIndex = currentIndex < phaseResults.filtered.length - 1 ? currentIndex + 1 : 0\n    }\n    const nextResult = phaseResults.filtered[nextIndex]\n    const domElement = this.cardRef.current.childNodes[nextIndex]\n    if (domElement !== undefined) {\n      domElement.scrollIntoView({ block: 'center', behavior: 'smooth' })\n    }\n    return this.setState({ autoPlayId: nextResult.n_PhaseResultID}, () => onSelectResult(nextResult, true))\n  }\n\n  triggerAutoScripts() {\n    const _this = this\n\n    if (this.state.autoRefresh === true) {\n      this.refreshTimer = window.setInterval(() => {\n        _this.onClickRefresh()\n      }, this.state.refreshInterval)\n    } else {\n      window.clearInterval(this.refreshTimer)\n    }\n\n    if (this.state.autoPlay === true) {\n      this.autoPlayTimer = window.setInterval(() => {\n        _this.focusNextResult()\n      }, this.state.autoPlayInterval)\n    } else {\n      window.clearInterval(this.autoPlayTimer)\n    }\n  }\n\n  render() {\n    const _this = this\n    const { selectedResult, globeStatus, filterOptions, setFilters, phaseResults } = this.props\n    const filteredResults = phaseResults.filtered\n    const poiResults = phaseResults.poi\n    const cardSource = poiResults.length > 0 ? poiResults : filteredResults\n    const athleteCards = cardSource.map( r =>{\n      let isActive = false\n      if (selectedResult !== null) {\n        isActive = selectedResult.n_PhaseResultID === r.n_PhaseResultID ? true : false\n      }\n      return <AthleteCard key={r.n_PhaseResultID} result={r} isActive={isActive} onClick={() => _this.onClickAthleteCard(r)} />\n    } )\n\n    const filterCssClass = `float-right btn btn-link ${this.state.showFilters ? '' : 'text-white'}`\n    const refreshCssClass = `float-right btn btn-link ${phaseResults.loading ? 'animation--rolling' : 'text-white'}`\n    const autoPlayCssClass = `float-right btn btn-link ${this.state.autoPlay ? '' : 'text-white'}`\n    const heading = cardSource.length > 0 ? `Found ${cardSource.length} champions over the last ${this.state.daysAgo} days` : 'Fetching data ...'\n\n    /** Spinning loader\n    const loader = phaseResults.loading === true ? (\n      <div className=\"d-flex p-3 align-items-center justify-content-center\">\n        <Spinner name=\"three-bounce\" color=\"#00bc8c\" />\n      </div>\n      ) : null\n    */\n\n    const cssClass = (globeStatus.viewDetails === true && this.state.autoPlay === false) ? 'detail--active' : ''\n\n    return (\n      <div className={`athlete-list__container ${cssClass}`}>\n        <div className=\"section__container\">\n          <div className=\"section px-3 pt-3 pb-0\">\n            <button onClick={this.onClickToggleFilters} className={filterCssClass} title=\"Toggle filters\">\n              <i className=\"material-icons md-48\">filter_list</i>\n            </button>\n            <button onClick={this.onClickRefresh} className={refreshCssClass} title=\"Refresh data\">\n              <i className=\"material-icons md-48\">refresh</i>\n            </button>\n            <button onClick={this.onClickAutoPlay} className={autoPlayCssClass} title=\"Autoplay\">\n              <i className=\"material-icons md-48\">play_arrow</i>\n            </button>\n            <h2>Aussie champions</h2>\n          </div>\n\n          <div className=\"section px-3\">\n            <AthleteFilters filterOptions={filterOptions} setFilters={setFilters} phaseResults={phaseResults} showFilters={this.state.showFilters} />\n            <h4 className=\"my-3 text-muted\">{heading}</h4>\n          </div>\n\n          <div className=\"section section--scrollable py-0 px-3\" ref={this.cardRef}>\n            {athleteCards}\n          </div>\n        </div>\n\n        <AthleteDetailCard selectedResult={selectedResult} onClick={() => _this.onCloseDetail()} />\n      </div>\n    );\n  }\n}\n\nexport default AthleteList","import React, { Component } from 'react'\nimport Globe from './Globe/Globe'\nimport AthleteList from './AthleteList/AthleteList'\nimport '../vendors/stylesheets/bootstrap/bootstrap.scss'\nimport './App.scss'\n\nclass App extends Component {\n  componentDidMount() {\n    this.props.fetchGraceNoteData({})\n  }\n\n  render() {\n    const { fetchGraceNoteData, phaseResults, selectedResult, onSelectResult, onUnselectResult, setPOI, unsetPOI, globeStatus, filterOptions, setFilters } = this.props\n    return (\n      <div className=\"container-fluid p-0\">\n        <div className=\"row no-gutters\">\n          <div className=\"col-lg-8\">\n            <Globe\n              phaseResults={phaseResults}\n              selectedResult={selectedResult}\n              globeStatus={globeStatus}\n              setPOI={setPOI}\n              unsetPOI={unsetPOI}\n            />\n          </div>\n          <div className=\"col-lg-4\">\n            <AthleteList\n              fetchGraceNoteData={fetchGraceNoteData}\n              phaseResults={phaseResults}\n              selectedResult={selectedResult}\n              onSelectResult={onSelectResult}\n              onUnselectResult={onUnselectResult}\n              globeStatus={globeStatus}\n              filterOptions={filterOptions}\n              setFilters={setFilters}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import { connect } from 'react-redux';\nimport { fetchGraceNoteData, selectResult, setPOI, unsetPOI, unselectResult, setFilters } from '../actions';\nimport App from '../components/App';\n\nconst mapStateToProps = state => {\n  return {\n    phaseResults: state.phaseResults,\n    selectedResult: state.selectedResult,\n    globeStatus: state.globeStatus,\n    filterOptions: state.filterOptions\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    fetchGraceNoteData: (options) => {\n      dispatch(fetchGraceNoteData(options));\n    },\n    onSelectResult: (result, isAutoPlay = false) => {\n      dispatch(selectResult(result, isAutoPlay))\n    },\n    onUnselectResult: () => {\n      dispatch(unselectResult())\n    },\n    setPOI: (lat, lng) => {\n      dispatch(setPOI(lat, lng))\n    },\n    unsetPOI: () => {\n      dispatch(unsetPOI())\n    },\n    setFilters: (newFilterValues) => {\n      dispatch(setFilters(newFilterValues))\n    }\n  };\n};\n\nconst AppContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(App);\n\nexport default AppContainer;\n","import fetch from 'isomorphic-fetch'\nimport * as types from '../constants/ActionTypes'\nimport countries from '../assets/data/countries.json'\nimport  countryCities from '../assets/data/countries-cities.json'\n\nexport const requestGraceNoteData = () => ({\n  type: types.REQUEST_GRACENOTE_DATA,\n})\n\nexport const receiveGraceNoteData = (json) => ({\n  type: types.RECEIVE_GRACENOTE_DATA,\n  json\n})\n\nexport const fetchGraceNoteData = (options) => {\n  const { daysAgo = 60, nationality = 'Australia', hasMedal = true, limit = 1000 } = options\n  const requestUrl = 'https://another-quang.github.io/build/assets/phaseresults.json'\n  // const requestUrl = `http://gracenotelocal/api/phaseresult?daysAgo=${daysAgo}&nationality=${nationality}&hasMedal=${hasMedal}&limit=${limit}`\n  // const requestUrl = `http://devauschamps:8000/api/phaseresult?daysAgo=${daysAgo}&nationality=${nationality}&hasMedal=${hasMedal}&limit=${limit}`\n  return dispatch => {\n    dispatch(requestGraceNoteData())\n    return fetch(requestUrl)\n      .then(response => response.json())\n      .then(json => {\n        const results = [];\n        if (json.length > 0) {\n          const subset = json.slice(0, limit)\n          subset.forEach(r => {\n            if (r.c_PhaseCountry !== null) {\n              const countryGeo = countries.find(c => c.Country === r.c_PhaseCountry)\n              const countryCode = countryGeo !== undefined ? countryGeo['Alpha-2 code'] : false\n              let cityGeo = undefined\n              const countryCity = countryCities.find(x => x.country === countryCode)\n              if (countryCity !== undefined) {\n                cityGeo = countryCity.cities.find(c => c.name === r.c_PhaseCity)\n              }\n              const geojson = cityGeo !== undefined ? cityGeo : (countryGeo !== undefined ? countryGeo : undefined)\n              // const geojson = countryGeo !== undefined ? countryGeo : undefined\n              if (geojson !== undefined) {\n                results.push({...r, geojson: geojson})\n              }\n            }\n          })\n        }\n        dispatch(receiveGraceNoteData(results))\n      })\n  }\n}\n\nexport const selectResult = (selectedResult, isAutoPlay) => ({\n  type: types.SELECT_RESULT,\n  selectedResult,\n  isAutoPlay\n})\n\nexport const unselectResult = selectedResult => ({\n  type: types.UNSELECT_RESULT,\n  selectedResult\n})\n\nexport const setPOI = (lat, lng) => ({\n  type: types.SET_POI,\n  lat,\n  lng\n})\n\nexport const unsetPOI = () => ({\n  type: types.UNSET_POI\n})\n\nexport const setFilters = (newFilterValues) => ({\n  type: types.SET_FILTER,\n  newFilterValues\n})","export const REQUEST_GRACENOTE_DATA = 'REQUEST_GRACENOTE_DATA'\nexport const RECEIVE_GRACENOTE_DATA = 'RECEIVE_GRACENOTE_DATA'\nexport const SELECT_RESULT = 'SELECT_RESULT'\nexport const UNSELECT_RESULT = 'UNSELECT_RESULT'\nexport const SET_POI = 'SET_POI'\nexport const UNSET_POI = 'UNSET_POI'\nexport const SET_FILTER = 'SET_FILTER'\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { REQUEST_GRACENOTE_DATA, RECEIVE_GRACENOTE_DATA, SET_POI, UNSET_POI, SET_FILTER } from '../constants/ActionTypes'\n\nconst initialState = {\n  all: [], // Everything\n  filtered: [], // Filtered\n  poi: [], // Near POI\n  loading: true,\n  error: null,\n  currentAutoPlayId: 0,\n}\n\nconst sortBy = (key, order) => {\n  const sortOrder = order === 'asc' ? 1 : -1\n  return (a, b) => (a[key] > b[key]) ? sortOrder : ((b[key] > a[key]) ? -sortOrder : 0)\n}\n\nconst phaseResults = (state = initialState, action) => {\n  switch (action.type) {\n    case REQUEST_GRACENOTE_DATA: {\n      return { ...state, loading: true, error: null }\n    }\n\n    case RECEIVE_GRACENOTE_DATA: {\n      if (action.json.length === 0) {\n        return state\n      }\n      return { ...state, loading: false, all: action.json, filtered: action.json }\n    }\n\n    case SET_POI: {\n      const distanceThreshold = 10\n      const copyState = []\n\n      state.filtered.forEach(x => {\n        const a = x.geojson.lat - action.lat\n        const b = x.geojson.lng - action.lng\n        copyState.push({ ...x, distance: Math.sqrt(a * a + b * b) })\n      })\n\n      const results = copyState.filter(x => x.distance < distanceThreshold).sort(sortBy('distance', 'asc'))\n      return { ...state, poi: results }\n    }\n\n    case UNSET_POI: {\n      return { ...state, poi: [] }\n    }\n\n    case SET_FILTER: {\n      const ignoreSportName = action.newFilterValues.sport === 'All' ? true : false\n      const ignoreGender = action.newFilterValues.gender === 'All' ? true : false\n      const ignoreMedal = action.newFilterValues.medal === 'All' ? true : false\n      const ignoreName = action.newFilterValues.name === '' ? true : false\n      let sortKey = ''\n      let order = ''\n      switch (action.newFilterValues.sortby) {\n        case 'time-asc' :\n          sortKey = 'd_PhaseDate'\n          order = 'asc'\n          break\n        default:\n          sortKey = 'd_PhaseDate'\n          order = 'desc'\n          break\n      }\n\n      return { ...state,\n        poi: [],\n        filtered: state.all.filter(x => {\n          return (x.c_Sportname === action.newFilterValues.sport || ignoreSportName)\n            && (x.c_EventGender === action.newFilterValues.gender || ignoreGender)\n            && (x.n_RankMedal === parseInt(action.newFilterValues.medal, 10) || ignoreMedal)\n            && ((x.c_Person !== null ? x.c_Person.toUpperCase().includes(action.newFilterValues.name.toUpperCase()) : false) || ignoreName)\n        }).sort(sortBy(sortKey, order))\n      }\n    }\n    default:\n      return state\n  }\n};\n\nexport default phaseResults\n","import { SELECT_RESULT, UNSET_POI, UNSELECT_RESULT } from '../constants/ActionTypes'\n\nconst initialState = {}\n\nconst selectedResult = (state = initialState, action) => {\n  switch (action.type) {\n    case SELECT_RESULT: {\n      return action.selectedResult\n    }\n    case UNSET_POI: {\n      return null\n    }\n    case UNSELECT_RESULT: {\n      return null\n    }\n    default:\n      return state\n  }\n}\n\nexport default selectedResult\n","import { SELECT_RESULT, UNSELECT_RESULT, UNSET_POI } from '../constants/ActionTypes'\n\nconst initialState = {\n  viewDetails: false\n}\n\nconst globeStatus = (state = initialState, action) => {\n  switch (action.type) {\n    case SELECT_RESULT: {\n      return Object.assign({}, state, { viewDetails: action.isAutoPlay === false ? true : false })\n      // return Object.assign({}  , state, { viewDetails: true })\n    }\n    case UNSELECT_RESULT: {\n      return Object.assign({}, state, { viewDetails: false })\n    }\n    case UNSET_POI: {\n      return Object.assign({}, state, { viewDetails: false })\n    }\n    default:\n      return state\n  }\n};\n\nexport default globeStatus\n","import { RECEIVE_GRACENOTE_DATA } from '../constants/ActionTypes'\n\nconst initialState = {\n  sport: [],\n  gender: [],\n  medal: [],\n}\n\nconst uniq = (array) => {\n  return [...new Set(array)]\n}\n\nconst getAvailableFields = (results, fieldName) => {\n  if (results.length > 0) {\n    const temp = uniq(results.map(x => x[fieldName])).sort()\n    temp.unshift('All')\n    return temp\n  }\n}\n\nconst filterOptions = (state = initialState, action) => {\n  switch (action.type) {\n    case RECEIVE_GRACENOTE_DATA: {\n      return Object.assign({}, state, {\n        sport: getAvailableFields(action.json, 'c_Sportname'),\n        gender: getAvailableFields(action.json, 'c_EventGender'),\n        medal: getAvailableFields(action.json, 'n_RankMedal'),\n      })\n    }\n\n    default:\n      return state\n  }\n};\n\nexport default filterOptions\n","import { combineReducers } from 'redux'\nimport phaseResults from './phaseResults'\nimport selectedResult from './selectedResult'\nimport globeStatus from './globeStatus'\nimport filterOptions from './filterOptions'\n\nconst rootReducer = combineReducers({\n  phaseResults,\n  selectedResult,\n  globeStatus,\n  filterOptions\n});\n\nexport default rootReducer;\n","import { applyMiddleware, createStore } from 'redux';\nimport thunk from 'redux-thunk';\nimport promise from 'redux-promise';\nimport { createLogger } from 'redux-logger';\nimport rootReducer from '../reducers';\n\nconst middlewares = process.env.NODE_ENV === 'production' ? [thunk, promise] : [thunk, promise, createLogger()];\n\nexport default function configureStore(initialState) {\n  const store = createStore(\n    rootReducer,\n    initialState,\n    applyMiddleware(...middlewares)\n  );\n\n  return store;\n}\n","import React from 'react';\nimport { render } from 'react-dom';\nimport AppContainer from './containers/AppContainer';\nimport * as serviceWorker from './serviceWorker';\nimport { Provider } from 'react-redux';\nimport configureStore from './store/configureStore';\n\nlet initialState = {};\nconst store = configureStore(initialState);\nrender(\n  <Provider store={store}>\n    <AppContainer />\n  </Provider>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}